/*

 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license

 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template

 */

package crud_productos;

import java.sql.*;

import javax.swing.JOptionPane;

import javax.swing.table.DefaultTableModel;

/**

 *

 * @author Alumno-ETI

 */

public class NewJFrame extends javax.swing.JFrame {



  /**

   * Creates new form NewJFrame

   */

  public NewJFrame() {

    initComponents();

    Cargar_Registros_en_la_tabla();

    conectar();

  }



  /**

   * This method is called from within the constructor to initialize the form.

   * WARNING: Do NOT modify this code. The content of this method is always

   * regenerated by the Form Editor.

   */

  @SuppressWarnings("unchecked")

  // <editor-fold defaultstate="collapsed" desc="Generated Code">              

  private void initComponents() {



    jScrollPane1 = new javax.swing.JScrollPane();

    jTable1 = new javax.swing.JTable();

    jLabel1 = new javax.swing.JLabel();

    jLabel2 = new javax.swing.JLabel();

    jLabel3 = new javax.swing.JLabel();

    txtID = new javax.swing.JTextField();

    txtName = new javax.swing.JTextField();

    btnIns = new javax.swing.JButton();

    btnAct = new javax.swing.JButton();

    btnEli = new javax.swing.JButton();

    jLabel4 = new javax.swing.JLabel();

    jLabel5 = new javax.swing.JLabel();

    jLabel6 = new javax.swing.JLabel();

    jLabel7 = new javax.swing.JLabel();

    jLabel8 = new javax.swing.JLabel();

    jLabel9 = new javax.swing.JLabel();

    txtpu = new javax.swing.JTextField();

    txtCpU = new javax.swing.JTextField();

    txts = new javax.swing.JTextField();

    txto = new javax.swing.JTextField();

    txtreo = new javax.swing.JTextField();

    txtd = new javax.swing.JTextField();



    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);



    jTable1.setModel(new javax.swing.table.DefaultTableModel(

      new Object [][] {

        {null, null, null, null},

        {null, null, null, null},

        {null, null, null, null},

        {null, null, null, null}

      },

      new String [] {

        "Title 1", "Title 2", "Title 3", "Title 4"

      }

    ));

    jScrollPane1.setViewportView(jTable1);



    jLabel1.setFont(new java.awt.Font("Californian FB", 0, 36)); // NOI18N

    jLabel1.setText("TABLA PRODUCTS");



    jLabel2.setText("ID Producto");



    jLabel3.setText("Nombre Producto");



    txtID.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtIDActionPerformed(evt);

      }

    });



    txtName.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtNameActionPerformed(evt);

      }

    });



    btnIns.setText("INSERTAR");

    btnIns.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        btnInsActionPerformed(evt);

      }

    });



    btnAct.setText("ACTUALIZAR");

    btnAct.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        btnActActionPerformed(evt);

      }

    });



    btnEli.setText("ELIMINAR");

    btnEli.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        btnEliActionPerformed(evt);

      }

    });



    jLabel4.setText("Cantidad por unidad");



    jLabel5.setText("Precio por unidad");



    jLabel6.setText("Unidad en stock");



    jLabel7.setText("Unidad en orden");



    jLabel8.setText("Reordenar");



    jLabel9.setText("Descontinuado");



    txtpu.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtpuActionPerformed(evt);

      }

    });



    txtCpU.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtCpUActionPerformed(evt);

      }

    });



    txts.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtsActionPerformed(evt);

      }

    });



    txto.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtoActionPerformed(evt);

      }

    });



    txtreo.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtreoActionPerformed(evt);

      }

    });



    txtd.addActionListener(new java.awt.event.ActionListener() {

      public void actionPerformed(java.awt.event.ActionEvent evt) {

        txtdActionPerformed(evt);

      }

    });



    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());

    getContentPane().setLayout(layout);

    layout.setHorizontalGroup(

      layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

      .addGroup(layout.createSequentialGroup()

        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

          .addGroup(layout.createSequentialGroup()

            .addGap(658, 658, 658)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)

              .addComponent(jLabel9)

              .addComponent(jLabel8))

            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

              .addComponent(txtreo, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE)

              .addComponent(txtd, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE)))

          .addGroup(layout.createSequentialGroup()

            .addGap(339, 339, 339)

            .addComponent(jLabel1))

          .addGroup(layout.createSequentialGroup()

            .addGap(20, 20, 20)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)

              .addComponent(jLabel3)

              .addComponent(jLabel2)

              .addComponent(jLabel4))

            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)

              .addGroup(layout.createSequentialGroup()

                .addComponent(txtCpU, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE)

                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)

                .addComponent(jLabel7))

              .addGroup(layout.createSequentialGroup()

                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

                  .addComponent(txtID, javax.swing.GroupLayout.PREFERRED_SIZE, 187, javax.swing.GroupLayout.PREFERRED_SIZE)

                  .addComponent(txtName, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE))

                .addGap(31, 31, 31)

                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)

                  .addComponent(jLabel6)

                  .addComponent(jLabel5))))

            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

              .addComponent(txtpu, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE)

              .addComponent(txts, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE)

              .addComponent(txto, javax.swing.GroupLayout.PREFERRED_SIZE, 188, javax.swing.GroupLayout.PREFERRED_SIZE))))

        .addGap(0, 68, Short.MAX_VALUE))

      .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()

        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)

        .addComponent(btnIns)

        .addGap(122, 122, 122)

        .addComponent(btnAct)

        .addGap(125, 125, 125)

        .addComponent(btnEli)

        .addGap(232, 232, 232))

      .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()

        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)

        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 891, javax.swing.GroupLayout.PREFERRED_SIZE)

        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))

    );

    layout.setVerticalGroup(

      layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

      .addGroup(layout.createSequentialGroup()

        .addGap(31, 31, 31)

        .addComponent(jLabel1)

        .addGap(17, 17, 17)

        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)

          .addComponent(txtID, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)

          .addComponent(jLabel2)

          .addComponent(jLabel5)

          .addComponent(txtpu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)

          .addComponent(jLabel8)

          .addComponent(txtreo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))

        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

          .addGroup(layout.createSequentialGroup()

            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)

              .addComponent(jLabel3)

              .addComponent(txtName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)

              .addComponent(jLabel6)

              .addComponent(txts, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))

            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)

              .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)

              .addComponent(txtCpU, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)

              .addComponent(jLabel7)

              .addComponent(txto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))

          .addGroup(layout.createSequentialGroup()

            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)

            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)

              .addComponent(jLabel9)

              .addComponent(txtd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))

        .addGap(61, 61, 61)

        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)

          .addComponent(btnIns)

          .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)

            .addComponent(btnEli)

            .addComponent(btnAct)))

        .addGap(18, 18, 18)

        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 443, javax.swing.GroupLayout.PREFERRED_SIZE)

        .addContainerGap(62, Short.MAX_VALUE))

    );



    pack();

  }// </editor-fold>             



  private void txtIDActionPerformed(java.awt.event.ActionEvent evt) {                    

    // TODO add your handling code here:

  }                   



  private void txtNameActionPerformed(java.awt.event.ActionEvent evt) {                     

    // TODO add your handling code here:

  }                    



  private void btnInsActionPerformed(java.awt.event.ActionEvent evt) {                    

    // TODO add your handling code here:

    Insertar();    

  }                    



  private void btnActActionPerformed(java.awt.event.ActionEvent evt) {                    

    // TODO add your handling code here:

    Actualizar();

  }                    



  private void btnEliActionPerformed(java.awt.event.ActionEvent evt) {                    

    // TODO add your handling code here:

    Eliminar();

  }                    



  private void txtreoActionPerformed(java.awt.event.ActionEvent evt) {                    

    // TODO add your handling code here:

  }                    



  private void txtCpUActionPerformed(java.awt.event.ActionEvent evt) {                    

    // TODO add your handling code here:

  }                    



  private void txtpuActionPerformed(java.awt.event.ActionEvent evt) {                    

    // TODO add your handling code here:

  }                   



  private void txtsActionPerformed(java.awt.event.ActionEvent evt) {                   

    // TODO add your handling code here:

  }                   



  private void txtoActionPerformed(java.awt.event.ActionEvent evt) {                   

    // TODO add your handling code here:

  }                   



  private void txtdActionPerformed(java.awt.event.ActionEvent evt) {                   

    // TODO add your handling code here:

  }                   



  /**

   * @param args the command line arguments

   */

  public static void main(String args[]) {

    /* Set the Nimbus look and feel */

    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">

    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.

     * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 

     */

    try {

      for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {

        if ("Nimbus".equals(info.getName())) {

          javax.swing.UIManager.setLookAndFeel(info.getClassName());

          break;

        }

      }

    } catch (ClassNotFoundException ex) {

      java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);

    } catch (InstantiationException ex) {

      java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);

    } catch (IllegalAccessException ex) {

      java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);

    } catch (javax.swing.UnsupportedLookAndFeelException ex) {

      java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);

    }

    //</editor-fold>



    /* Create and display the form */

    java.awt.EventQueue.invokeLater(new Runnable() {

      public void run() {

        new NewJFrame().setVisible(true);

      }

    });

  }

  public Connection conectar() {

    Connection cn = null;

    try{

      cn = DriverManager.getConnection("jdbc:sqlserver://localhost:1433;databaseName=Northwind;encrypt=false", "sa", "1234");

    } catch (Exception e){

      System.out.println(e);

    }

    return cn;

  }

   

  public ResultSet obtener_registros() {

    String consulta_base_de_datos = "SELECT * FROM Products;";

    ResultSet resultados = null;

    try {

     Statement sentencia = conectar().createStatement();

      

     resultados = sentencia.executeQuery(consulta_base_de_datos);

      

    }catch(SQLException e) {

      System.out.println(e);

    }

    return resultados;

  }

   

  public void Cargar_Registros_en_la_tabla() {

    ResultSet resultados = obtener_registros();

    String[] columnNames = {"ProductID", "ProductName", "QuantityPerUnit", "UnitPrice", "UnitsInStock", "UnitsOnOrder", "ReorderLevel", "Discontinued"};

    DefaultTableModel model = new DefaultTableModel(null, columnNames);

     

    try{

      while(resultados.next()) {

        String [] registro = {

          String.valueOf(resultados.getInt("ProductID")),

          resultados.getString("ProductName"),

          resultados.getString("QuantityPerUnit"),

          String.valueOf(resultados.getDouble("UnitPrice")),

          String.valueOf(resultados.getInt("UnitsInStock")),

          String.valueOf(resultados.getInt("UnitsOnOrder")),

          String.valueOf(resultados.getInt("ReorderLevel")),

          String.valueOf(resultados.getBoolean("Discontinued"))

        };

        model.addRow(registro);

      }

    } catch (SQLException e) {

      System.out.println(e);

    }

     



    jTable1.setModel(model);

  }

   public void Insertar(){

    String consulta_base_de_datos = "SET IDENTITY_INSERT Products ON;"

     + "INSERT INTO Products(ProductID, ProductName, QuantityPerUnit, UnitPrice, UnitsInStock, UnitsOnOrder, ReorderLevel, Discontinued) VALUES (?,?,?,?,?,?,?,?)";

    int ProductID = Integer.parseInt(txtID.getText());

    String ProductName = txtName.getText();

    String QuantityPerUnit = txtCpU.getText();

    double UnitPrice = Double.parseDouble(txtpu.getText());

    int UnitsInStock = Integer.parseInt(txts.getText());

    int UnitsOnOrder = Integer.parseInt(txto.getText());

    int ReorderLevel = Integer.parseInt(txtreo.getText());

    boolean Discontinued = Boolean.parseBoolean(txtd.getText());

    try {

      PreparedStatement sentencia_preparada = conectar().prepareStatement(consulta_base_de_datos);

      sentencia_preparada.setInt(1, ProductID);

      sentencia_preparada.setString(2, ProductName);

      sentencia_preparada.setString(3, QuantityPerUnit);

      sentencia_preparada.setDouble(4, UnitPrice);

      sentencia_preparada.setInt(5, UnitsInStock);

      sentencia_preparada.setInt(6, UnitsOnOrder);

      sentencia_preparada.setInt(7, ReorderLevel);

      sentencia_preparada.setBoolean(8, Discontinued);

       

      sentencia_preparada.executeUpdate();

    } catch (SQLException e) {

      JOptionPane.showMessageDialog(null, e);

    }

     

    Cargar_Registros_en_la_tabla();

  }

   

  public void Actualizar(){

    String consulta_base_de_datos = "UPDATE Products SET ProductName = ?, QuantityPerUnit = ?, UnitPrice=?, UnitsInStock=?, UnitsOnOrder=?, ReorderLevel=?, Discontinued=? WHERE ProductID = ?";

    int ProductID = Integer.parseInt(txtID.getText());

    String ProductName = txtName.getText();

    String QuantityPerUnit = txtCpU.getText();

    double UnitPrice = Double.parseDouble(txtpu.getText());

    int UnitsInStock = Integer.parseInt(txts.getText());

    int UnitsOnOrder = Integer.parseInt(txto.getText());

    int ReorderLevel = Integer.parseInt(txtreo.getText());

    boolean Discontinued = Boolean.parseBoolean(txtd.getText());

   

    try {

      PreparedStatement sentencia_preparada = conectar().prepareStatement(consulta_base_de_datos);

      sentencia_preparada.setString(1, ProductName);

      sentencia_preparada.setInt(2, ProductID);

      sentencia_preparada.setString(3, QuantityPerUnit);

      sentencia_preparada.setDouble(4, UnitPrice);

      sentencia_preparada.setInt(5, UnitsInStock);

      sentencia_preparada.setInt(6, UnitsOnOrder);

      sentencia_preparada.setInt(7, ReorderLevel);

      sentencia_preparada.setBoolean(8, Discontinued);

     

      sentencia_preparada.executeUpdate();

    } catch (SQLException e) {

      JOptionPane.showMessageDialog(null, e);

    }

   

    Cargar_Registros_en_la_tabla();

  }

   

  public void Eliminar(){

    String consulta_base_de_datos = "DELETE FROM Products WHERE ProductID = ?";

    int ProductID = Integer.parseInt(txtID.getText());

    try {

      PreparedStatement sentencia_preparada = conectar().prepareStatement(consulta_base_de_datos);

      sentencia_preparada.setInt(1, ProductID);

       

      sentencia_preparada.executeUpdate();

    } catch (SQLException e) {

      JOptionPane.showMessageDialog(null, e);

    }

     

    Cargar_Registros_en_la_tabla();

  }



  // Variables declaration - do not modify           

  private javax.swing.JButton btnAct;

  private javax.swing.JButton btnEli;

  private javax.swing.JButton btnIns;

  private javax.swing.JLabel jLabel1;

  private javax.swing.JLabel jLabel2;

  private javax.swing.JLabel jLabel3;

  private javax.swing.JLabel jLabel4;

  private javax.swing.JLabel jLabel5;

  private javax.swing.JLabel jLabel6;

  private javax.swing.JLabel jLabel7;

  private javax.swing.JLabel jLabel8;

  private javax.swing.JLabel jLabel9;

  private javax.swing.JScrollPane jScrollPane1;

  private javax.swing.JTable jTable1;

  private javax.swing.JTextField txtCpU;

  private javax.swing.JTextField txtID;

  private javax.swing.JTextField txtName;

  private javax.swing.JTextField txtd;

  private javax.swing.JTextField txto;

  private javax.swing.JTextField txtpu;

  private javax.swing.JTextField txtreo;

  private javax.swing.JTextField txts;

  // End of variables declaration          

}